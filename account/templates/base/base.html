{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>Home</title>
</head>
<body>

  <!-- Sidebar -->
  <aside class="fixed top-0 left-0 h-full w-16 bg-white border-r flex flex-col items-center py-4 z-40">
    <!-- Logo Icon -->
    <a href="/" class="mb-8">
      <img src="{% static 'assets/images/Logo.svg' %}" alt="Logo" class="h-8 w-8" />
    </a>
    <!-- Nav Icons -->
    <nav class="flex flex-col space-y-6">
      <a href="#" class="text-gray-400 hover:text-black">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" ...> <!-- Home Icon SVG --></svg>
      </a>
      <a href="#" class="text-gray-400 hover:text-black">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" ...> <!-- Collections Icon SVG --></svg>
      </a>
      <a href="#" class="text-gray-400 hover:text-black">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" ...> <!-- Upload Icon SVG --></svg>
      </a>
      <!-- Add more icons as needed -->
    </nav>
  </aside>

  <!-- Top Navbar -->
  <header class="fixed top-0 left-16 right-0 h-16 bg-white border-b flex items-center px-6 z-30">
    <!-- Mobile menu button -->
    <button id="mobile-nav-toggle" class="md:hidden mr-4 text-gray-700 focus:outline-none" aria-label="Toggle navigation">
      <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <!-- Search Bar -->
    <form class="flex-1 flex items-center max-w-xl mx-auto order-2 md:order-none w-full md:w-auto">
      <div class="relative w-full">
        <input
          id="navbar-search-input"
          type="text"
          placeholder="Search photos and illustrations"
          class="w-full px-4 py-2 pr-10 rounded-full border bg-gray-100 focus:outline-none"
        />
        <button id="navbar-search-btn" type="submit" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z" /></svg>
        </button>
      </div>
    </form>
    <!-- Right Buttons -->
    <div id="navbar-links" class="flex flex-col md:flex-row items-center space-y-2 md:space-y-0 md:space-x-4 ml-0 md:ml-6 absolute md:static top-16 left-0 right-0 bg-white md:bg-transparent border-b md:border-0 shadow md:shadow-none z-40 md:z-0 hidden md:flex">
      <a href="#" class="text-gray-700 font-medium hover:underline">Get Unsplash+</a>
      <a href="#" class="bg-gray-100 px-4 py-2 rounded border text-gray-700 font-medium hover:bg-gray-200">Submit an image</a>
       <a
          href="{% url 'collection_list' %}"
          class="{% if '/collections' in request.path %}text-gray-900 font-semibold border-b-2 border-gray-900{% else %}text-gray-500 hover:text-gray-900{% endif %} px-2 py-1"
        >
          Collections
        </a>
      <!-- User Icon or Avatar -->
      <a href="#" class="ml-0 md:ml-2">
        <svg class="h-8 w-8 text-gray-400" fill="none" stroke="currentColor" ...> <!-- User Icon SVG --></svg>
      </a>
    </div>
    <script>
      // Responsive navbar toggle
      document.addEventListener('DOMContentLoaded', function() {
        const navToggle = document.getElementById('mobile-nav-toggle');
        const navLinks = document.getElementById('navbar-links');
        if (navToggle && navLinks) {
          navToggle.addEventListener('click', function() {
            navLinks.classList.toggle('hidden');
          });
          // Hide links by default on mobile
          if (window.innerWidth < 768) {
            navLinks.classList.add('hidden');
          }
          window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
              navLinks.classList.remove('hidden');
            } else {
              navLinks.classList.add('hidden');
            }
          });
        }
      });
    </script>
  </header>

    <!-- Main Content Wrapper (add margin to avoid overlap) -->
    <main class="ml-16 pt-16">
      {% block content %}
      {% endblock %}
    </main>

    {% if messages %}
    {% for message in messages %}
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        Swal.fire({
          icon: "{% if message.tags == 'success' %}success{% elif message.tags == 'error' %}error{% else %}info{% endif %}",
          title: "{{ message|escapejs }}",
          draggable: true,
          showConfirmButton: false,
          timer: 2000
        });
      });
    </script>
      {% endfor %}
  {% endif %}
</body>

  <footer class="bg-gray-50 mt-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <p class="text-center text-gray-500 text-sm">
        &copy; 2023 UnsplashBox. All rights reserved.
      </p>
    </div>
  </footer>


  
    <script>
      // Navbar search functionality (fetch Unsplash images and display in main content, matching gallery format)
      document.addEventListener('DOMContentLoaded', function() {
        const searchForm = document.querySelector('form.flex-1');
        const searchInput = document.getElementById('navbar-search-input');
        const mainContent = document.querySelector('main');
        function unauthAlert(e) {
          e.preventDefault();
          Swal.fire({
            icon: 'info',
            title: 'Login Required',
            text: 'Please login to use this feature.',
            showCancelButton: true,
            confirmButtonText: 'Go to Login',
            cancelButtonText: 'Skip',
            allowOutsideClick: true
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = "/login/";
            }
          });
        }
        if (searchForm && searchInput && mainContent) {
          searchForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const query = searchInput.value.trim() + ' Africa';
            if (!query) return;
            // Show loading spinner
            mainContent.innerHTML = '<div class="flex justify-center items-center h-64"><div class="w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"></div></div>';
            // Fetch Unsplash images
            const response = await fetch(`https://api.unsplash.com/search/photos?query=${encodeURIComponent(query)}&client_id=FEN7muUAoBMnLCKKJUDeWOItY2G9jg-45WY_P2u16J8`);
            const data = await response.json();
            // Render images in gallery format
            mainContent.innerHTML = `<div id='gallery' class='columns-2 sm:columns-3 md:columns-4 gap-4 px-4 sm:px-6 lg:px-8 mt-10'>` +
              data.results.map(img => `
                <div class="mb-4 break-inside-avoid">
                  <div class="relative group rounded-lg shadow-md overflow-hidden">
                    <a href="/collection_detail?image_id=${img.id}" class="block">
                      <img src="${img.urls.small}" alt="${img.alt_description || ''}" class="w-full rounded-lg transition-transform duration-300 group-hover:scale-105" />
                    </a>
                    <!-- Overlay (not inside <a>) -->
                    <div class="absolute inset-0 flex flex-col justify-between opacity-0 group-hover:opacity-100 transition duration-300 bg-gradient-to-t from-black/60 via-black/10 to-transparent pointer-events-none">
                      <!-- Top Right Buttons -->
                      <div class="flex justify-end p-2 space-x-2">
                        <button class="bg-white/80 hover:bg-white text-gray-800 rounded-full p-2 shadow-md transition pointer-events-auto" title="Like">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" /></svg>
                        </button>
                        <a href="#" onclick="unauthAlert(event)" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium px-2 py-1 text-sm rounded-lg flex items-center transition">+ Collection</a>
                      </div>
                      <!-- Bottom Left Download Button -->
                      <div class="flex justify-start p-2">
                        <a href="${img.links.download}" target="_blank" class="px-3 py-1 bg-white text-black text-xs font-medium rounded-md hover:bg-gray-200 transition shadow-md pointer-events-auto">Download</a>
                      </div>
                    </div>
                  </div>
                </div>
              `).join('') + '</div>';
          });
        }
      });
    </script>
</html>